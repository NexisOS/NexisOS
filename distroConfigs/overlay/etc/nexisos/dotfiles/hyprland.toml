# hyprland.toml
[users.kg.files]

# Hyprland configuration
[users.kg.files."~/.config/hypr/hyprland.conf"]
text = """
# This is an example Hyprland config file.
# Refer to the wiki for more information.
# https://wiki.hypr.land/Configuring/

# Please note not all available settings / options are set here.
# For a full list, see the wiki

# You can split this configuration into multiple files
# Create your files separately and then link them to this file like this:
# source = ~/.config/hypr/myColors.conf

################
### MONITORS ###
################

monitor = DP-1, highres, auto, 2

###################
### MY PROGRAMS ###
###################

$terminal = wezterm
$fileManager = dolphin
$menu = wofi --show drun

#################
### AUTOSTART ###
#################

exec-once = sleep 1 && hyprpaper &
exec-once = hypridle &
exec-once = nm-applet --indicator &
exec-once = mako &
exec-once = eww daemon && sleep 1 && eww open bar

#############################
### ENVIRONMENT VARIABLES ###
#############################

env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24
env = QT_QPA_PLATFORMTHEME,kde
env = QT_STYLE_OVERRIDE,breeze
env = GTK_THEME,Monokai

###################
### PERMISSIONS ###
###################

# ecosystem {
#   enforce_permissions = 1
# }
# permission = /usr/(bin|local/bin)/grim, screencopy, allow
# permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-hyprland, screencopy, allow
# permission = /usr/(bin|local/bin)/hyprpm, plugin, allow

#####################
### LOOK AND FEEL ###
#####################

general {
    gaps_in = 5
    gaps_out = 20
    border_size = 2
    col.active_border = rgb(F92672) rgb(AE81FF) 45deg
    col.inactive_border = rgb(49483E)
    resize_on_border = false
    allow_tearing = false
    layout = dwindle
}

decoration {
    rounding = 1
    rounding_power = 2
    active_opacity = 1.0
    inactive_opacity = 1.0

    shadow {
        enabled = true
        range = 4
        render_power = 3
        color = rgba(1a1a1aee)
    }

    blur {
        enabled = true
        size = 3
        passes = 1
        vibrancy = 0.1696
    }
}

animations {
    enabled = yes, please :)
    bezier = easeOutQuint,   0.23, 1,    0.32, 1
    bezier = easeInOutCubic, 0.65, 0.05, 0.36, 1
    bezier = linear,         0,    0,    1,    1
    bezier = almostLinear,   0.5,  0.5,  0.75, 1
    bezier = quick,          0.15, 0,    0.1,  1
    animation = global,        1,     5,    default
    animation = border,        1,     5.39,  easeOutQuint
    animation = windows,       1,     4.79,  easeOutQuint
    animation = windowsIn,     1,     4.1,   easeOutQuint, popin 87%
    animation = windowsOut,    1,     1.49,  linear,       popin 87%
    animation = fadeIn,        1,     1.73,  almostLinear
    animation = fadeOut,       1,     1.46,  almostLinear
    animation = fade,          1,     3.03,  quick
    animation = layers,        1,     3.81,  easeOutQuint
    animation = layersIn,      1,     4,     easeOutQuint, fade
    animation = layersOut,     1,     1.5,   linear,       fade
    animation = fadeLayersIn,  1,     1.79,  almostLinear
    animation = fadeLayersOut, 1,     1.39,  almostLinear
    animation = workspaces,    1,     1.94,  almostLinear, fade
    animation = workspacesIn,  1,     1.21,  almostLinear, fade
    animation = workspacesOut, 1,     1.94,  almostLinear, fade
    animation = zoomFactor,    1,     7,     quick
}

dwindle {
    pseudotile = true
    preserve_split = true
}

master {
    new_status = master
}

misc {
    force_default_wallpaper = -1
    disable_hyprland_logo = false
}

input {
    kb_layout = us
    kb_variant = ""
    kb_model = ""
    kb_options = ""
    kb_rules = ""
    follow_mouse = 1
    sensitivity = 0

    touchpad {
        natural_scroll = false
    }
}

gesture = 3, horizontal, workspace

device {
    name = epic-mouse-v1
    sensitivity = -0.5
}

$mainMod = SUPER

# Keybindings, window/workspace rules, etc. can stay in the literal text
binds = """
bind = $mainMod, Q, exec, $terminal
bind = $mainMod, C, killactive,
bind = $mainMod, M, exit,
...
windowrule = float, class:^(wofi|pavucontrol)$
layerrule = blur, bar
layerrule = ignorezero, bar
layerrule = blur, start-menu
layerrule = blur, keybindings
layerrule = dimaround, bar
"""

[users.kg.files."/home/kg/.config/hypr/hyprpaper.conf"]
text = """
preload = /home/kg/Pictures/wallpaper3.jpg
wallpaper = ,/home/kg/Pictures/wallpaper3.jpg
"""

[users.kg.files."/home/kg/.config/eww/eww.yuck"]
text = """
;; NexisOS Monokai KDE-style Bottom Bar (Hyprland-ready)

;; Variables
(defvar start_menu_open false)

;; Polls
(defpoll time :interval "1s" "date '+%a %b %d  %H:%M'")
(defpoll battery :interval "10s" "scripts/battery.sh")
(defpoll volume :interval "1s" "scripts/volume.sh")
(defpoll network :interval "5s" "scripts/network.sh")

;; Main Bar (KDE-style bottom panel)
(defwindow bar
  :monitor 0
  :geometry (geometry
    :x "0%"
    :y "0%"
    :width "100%"
    :height "60px"
    :anchor "bottom center")
  :stacking "fg"
  :exclusive true
  :focusable false
  (bar_layout))

(defwidget bar_layout []
  (box :class "bar"
       :orientation "h"
       :space-evenly false
    (box :class "bar-left"
         :halign "start"
         :spacing 10
         :space-evenly false
      (start_button)
      (workspaces))
    (box :class "bar-center"
         :halign "center"
      (clock))
    (box :class "bar-right"
         :halign "end"
         :spacing 10
         :space-evenly false
      (net)
      (bat)
      (vol)
      (keybindings_button))))

;; Start Menu Button
(defwidget start_button []
  (button :class "start-button"
          :onclick "eww open --toggle start-menu"
    (image :path "/home/kg/Pictures/nexisos.svg"
           :image-width 50
           :image-height 50)))

;; Workspaces
(defwidget workspaces []
  (box :class "workspaces"
       :orientation "h"
       :spacing 5
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 1" "1")
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 2" "2")
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 3" "3")
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 4" "4")
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 5" "5")
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 6" "6")
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 7" "7")
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 8" "8")
    (button :class "workspace-button"
            :onclick "hyprctl dispatch workspace 9" "9")))

;; Clock
(defwidget clock []
  (box :class "clock"
    (label :text time)))

;; Network, Battery, Volume
(defwidget net []
  (box :class "network"
    (label :text "󰖩 ''${network}")))

(defwidget bat []
  (box :class "battery"
    (label :text "''${battery}%")))

(defwidget vol []
  (box :class "volume"
    (label :text "󰕾 ''${volume}%")))

;; Keybindings Button
(defwidget keybindings_button []
  (button :class "keybindings-button"
          :onclick "eww open --toggle keybindings"
          :tooltip "Keybindings"
    (label :text "󰌌")))

;; Start Menu Popup
(defwindow start-menu
  :monitor 0
  :geometry (geometry
    :x "10px"
    :y "70px"
    :width "300px"
    :height "420px"
    :anchor "bottom left")
  :stacking "overlay"
  :focusable false
  (eventbox :onhover "true"
            :onhoverlost "eww close start-menu"
    (box :class "start-menu"
         :orientation "v"
         :space-evenly false
         :spacing 12
      (button :class "launcher-button"
              :onclick "wofi --show drun & eww close start-menu"
        (label :text "Launch Applications"))
      (box :class "separator"
        (label :text " "))
      (box :class "power-buttons"
           :orientation "v"
           :spacing 6
        (button :class "power-button"
                :onclick "systemctl suspend && eww close start-menu"
          (label :text "󰤄  Sleep"))
        (button :class "power-button"
                :onclick "hyprctl dispatch exit && eww close start-menu"
          (label :text "󰍃  Log Out"))
        (button :class "power-button"
                :onclick "systemctl poweroff && eww close start-menu"
          (label :text "󰐥  Shut Down"))))))

;; Keybindings Popup
(defwindow keybindings
  :monitor 0
  :geometry (geometry
    :x "10px"
    :y "70px"
    :width "400px"
    :height "500px"
    :anchor "bottom right")
  :stacking "overlay"
  :focusable false
  (eventbox :onhover "true"
            :onhoverlost "eww close keybindings"
    (box :class "keybindings"
         :orientation "v"
         :space-evenly false
      (box :class "keybindings-header"
        (label :text "Keybindings"))
      (scroll :vscroll true
              :hscroll false
        (box :class "keybindings-content"
             :orientation "v"
             :spacing 5
          (label :text "SUPER + Q → Terminal" :halign "start")
          (label :text "SUPER + E → File Manager" :halign "start")
          (label :text "SUPER + R → App Launcher" :halign "start")
          (label :text "SUPER + C → Close Window" :halign "start")
          (label :text "SUPER + V → Float Toggle" :halign "start")
          (label :text "SUPER + 1-9 → Switch Workspace" :halign "start")
          (label :text "SUPER + SHIFT + 1-9 → Move to Workspace" :halign "start"))))))
"""


[users.kg.files."/home/kg/.config/eww/eww.scss"]
text = """
/*
   NexisOS Monokai KDE-style Bottom Bar
   Colors inspired by Monokai: 
   Background Bar: #3E3D32 (gray)
   Dark buttons: #272822 (almost black)
   Text: #F8F8F2 (off-white)
   Cyan: #66D9EF
   Green: #A6E22E
   Pink: #F92672
   Purple: #AE81FF
   Orange: #FD971F
*/

* {
  font-family: "Noto Sans", sans-serif;
  font-size: 13px;
}

/* Main bar - Gray background */
.bar {
  background-color: #3E3D32;
  color: #F8F8F2;
  padding: 0 10px;
  border-top: 2px solid #49483E;
}

/* Left, center, right sections */
.bar-left, .bar-center, .bar-right {
  padding: 5px;
}

/* Start button and keybindings button */
.start-button, .keybindings-button {
  background-color: #272822;
  color: #F8F8F2;
  padding: 6px 10px;
  border-radius: 4px;
}

.start-button:hover {
  background-color: #66D9EF;
}

.keybindings-button:hover {
  background-color: #AE81FF;
}

/* Workspaces */
.workspaces {
  padding: 2px;
}

.workspace-button {
  background-color: #272822;
  color: #F8F8F2;
  padding: 5px 12px;
  margin: 0 2px;
  border-radius: 4px;
}

.workspace-button:hover {
  background-color: #FD971F;
}

/* Center clock */
.clock {
  color: #F8F8F2;
  font-weight: bold;
  font-size: 14px;
}

/* Right section */
.network, .battery, .volume {
  padding: 0 8px;
}

.network { 
  color: #66D9EF;
}

.battery { 
  color: #A6E22E;
}

.volume { 
  color: #AE81FF;
}

/* Start Menu */
.start-menu {
  background-color: #272822;
  color: #F8F8F2;
  border: 2px solid #49483E;
  border-radius: 8px;
  padding: 15px;
}

.launcher-button {
  background-color: #3E3D32;
  color: #F8F8F2;
  padding: 16px;
  border-radius: 6px;
  font-size: 15px;
  font-weight: bold;
}

.launcher-button:hover {
  background-color: #66D9EF;
}

/* Separators */
.separator {
  border-bottom: 1px solid #49483E;
  margin: 8px 0;
}

/* Power buttons */
.power-buttons {
  padding-top: 5px;
}

.power-button {
  background-color: #3E3D32;
  color: #F8F8F2;
  padding: 12px;
  margin: 3px 0;
  border-radius: 4px;
}

.power-button:hover {
  background-color: #F92672;
}

/* Keybindings popup */
.keybindings {
  background-color: #272822;
  color: #F8F8F2;
  border: 2px solid #49483E;
  border-radius: 8px;
  padding: 15px;
}

.keybindings-header {
  font-size: 17px;
  font-weight: bold;
  color: #F92672;
  padding-bottom: 12px;
  border-bottom: 2px solid #49483E;
  margin-bottom: 12px;
}

.keybindings-content {
  padding: 5px;
}

.keybindings-content label {
  color: #F8F8F2;
  padding: 6px 0;
  font-size: 13px;
}
"""

[users.kg.files."/home/kg/.config/eww/scripts/battery.sh"]
mode = 0o755
owner = ""
immutable = ture
replace = true
text = """
#!/bin/sh
bat_capacity=$(cat /sys/class/power_supply/BAT*/capacity 2>/dev/null || echo "N/A")
echo "$bat_capacity"
""

[users.kg.files."/home/kg/.config/eww/scripts/volume.sh"]
text = """
#!/bin/sh
# Try wpctl first (PipeWire), then pactl (PulseAudio)
if command -v wpctl >/dev/null 2>&1; then
  volume=$(wpctl get-volume @DEFAULT_AUDIO_SINK@ | awk '{print int($2 * 100)}')
elif command -v pactl >/dev/null 2>&1; then
  volume=$(pactl get-sink-volume @DEFAULT_SINK@ | grep -oP '\d+%' | head -1 | tr -d '%')
else
  volume="0"
fi
echo "$volume"
"""

[users.kg.files."/home/kg/.config/eww/scripts/network.sh"]
text = """
#!/bin/sh
if command -v nmcli >/dev/null 2>&1; then
  ssid=$(nmcli -t -f active,ssid dev wifi | grep '^yes' | cut -d: -f2)
  if [ -n "$ssid" ]; then
    echo "$ssid"
  else
    echo "Disconnected"
  fi
else
  echo "N/A"
fi
"""
